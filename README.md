# WSL Smart Home Camera ğŸ“·ğŸ 

**WSL2 + USBã‚«ãƒ¡ãƒ© + Nature Remo ã§ã€AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒéƒ¨å±‹ã‚’è¦‹ã¦å®¶é›»ã‚’æ“ä½œã™ã‚‹**

AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆ[OpenClaw](https://github.com/openclaw/openclaw)ï¼‰ãŒ USB ã‚«ãƒ¡ãƒ©ã§éƒ¨å±‹ã‚’æ’®å½±ãƒ»åˆ†æã—ã€Nature Remo API çµŒç”±ã§ç…§æ˜ãƒ»ã‚¨ã‚¢ã‚³ãƒ³ãƒ»ãƒ†ãƒ¬ãƒ“ãªã©ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ã‚¬ã‚¤ãƒ‰ã§ã™ã€‚

## æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Windows PC                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ USB Camera â”‚â”€â”€â”€â”€â–¶â”‚  WSL2 (Ubuntu)     â”‚  â”‚
â”‚  â”‚ (Depstech) â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚  OpenClaw    â”‚  â”‚  â”‚
â”‚    usbipd-win       â”‚  â”‚  (AI Agent)  â”‚  â”‚  â”‚
â”‚                     â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚ HTTPS
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚  Nature Remo Cloud API â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚ IR
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚  å®¶é›»ï¼ˆç…§æ˜/ã‚¨ã‚¢ã‚³ãƒ³/TVï¼‰â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ã§ãã‚‹ã“ã¨

- ğŸ“· **éƒ¨å±‹ã®æ’®å½±** â€” USBã‚«ãƒ¡ãƒ©ã§å®šæœŸçš„ã«æ’®å½±
- ğŸ‘ï¸ **ç”»åƒåˆ†æ** â€” AI ãŒéƒ¨å±‹ã®çŠ¶æ…‹ã‚’åˆ¤å®šï¼ˆé›»æ°—ON/OFFã€äººã®åœ¨/ä¸åœ¨ã€æ•£ã‚‰ã‹ã‚Šå…·åˆï¼‰
- ğŸ’¡ **å®¶é›»æ“ä½œ** â€” Nature Remo API ã§ç…§æ˜ãƒ»ã‚¨ã‚¢ã‚³ãƒ³ãƒ»ãƒ†ãƒ¬ãƒ“ã‚’åˆ¶å¾¡
- ğŸ”„ **æ“ä½œâ†’æ’®å½±â†’ç¢ºèªãƒ«ãƒ¼ãƒ—** â€” æ“ä½œçµæœã‚’ã‚«ãƒ¡ãƒ©ã§æ¤œè¨¼

## å¿…è¦ãªã‚‚ã®

| é …ç›® | è©³ç´° |
|------|------|
| **OS** | Windows 10/11 + WSL2 (Ubuntu) |
| **ã‚«ãƒ¡ãƒ©** | USB Webã‚«ãƒ¡ãƒ©ï¼ˆä¾‹: Depstech webcamï¼‰ |
| **ã‚¹ãƒãƒ¼ãƒˆãƒªãƒ¢ã‚³ãƒ³** | [Nature Remo](https://nature.global/) |
| **ãƒ„ãƒ¼ãƒ«** | ffmpeg, usbipd-win |
| **AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ** | [OpenClaw](https://github.com/openclaw/openclaw)ï¼ˆæ¨å¥¨ï¼‰ã¾ãŸã¯ä»»æ„ã® LLM |

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### 1. usbipd-win ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Windows å´ã§ USB ãƒ‡ãƒã‚¤ã‚¹ã‚’ WSL ã«è»¢é€ã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã€‚

```powershell
# Windows PowerShell (ç®¡ç†è€…)
winget install --id dorssel.usbipd-win
```

> âš ï¸ **ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã€UACãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã€Œã¯ã„ã€ã‚’æŠ¼ã™**

### 2. USB ã‚«ãƒ¡ãƒ©ã‚’ WSL ã«ã‚¢ã‚¿ãƒƒãƒ

```powershell
# Windows PowerShell (ç®¡ç†è€…)

# ã‚«ãƒ¡ãƒ©ã® BUSID ã‚’ç¢ºèª
usbipd list

# å‡ºåŠ›ä¾‹:
# BUSID  VID:PID    DEVICE                          STATE
# 1-3    1d6c:0103  Depstech webcam                 Not shared

# ãƒã‚¤ãƒ³ãƒ‰ï¼ˆåˆå›ã®ã¿ï¼‰
usbipd bind --busid 1-3

# WSL ã«ã‚¢ã‚¿ãƒƒãƒ
usbipd attach --wsl --busid 1-3
```

```bash
# WSL å´ã§æ¨©é™ã‚’è¨­å®š
sudo chmod 666 /dev/video0 /dev/video1
```

### 3. ffmpeg ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# WSL (Ubuntu)
sudo apt install -y ffmpeg
```

### 4. æ’®å½±ãƒ†ã‚¹ãƒˆ

```bash
# MJPEG ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã€1920x1080 ã§æ’®å½±
ffmpeg -f v4l2 -input_format mjpeg -video_size 1920x1080 \
  -i /dev/video0 -frames:v 1 -update 1 /tmp/camera.jpg -y
```

> Windows å´ã‹ã‚‰ã¯ `\\wsl$\Ubuntu\tmp\camera.jpg` ã§ç¢ºèªã§ãã¾ã™

### 5. Nature Remo API ã®è¨­å®š

1. https://home.nature.global/ ã«ãƒ­ã‚°ã‚¤ãƒ³
2. å³ä¸Šã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œã€
3. ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å®‰å…¨ã«ä¿å­˜:

```bash
mkdir -p ~/.config/nature-remo
echo -n "YOUR_TOKEN_HERE" > ~/.config/nature-remo/token
chmod 600 ~/.config/nature-remo/token
```

4. å®¶é›»ä¸€è¦§ã®å–å¾—:

```bash
TOKEN=$(cat ~/.config/nature-remo/token)
curl -s -H "Authorization: Bearer $TOKEN" \
  https://api.nature.global/1/appliances | python3 -m json.tool
```

### 6. å®¶é›»æ“ä½œ

```bash
TOKEN=$(cat ~/.config/nature-remo/token)

# ç…§æ˜ ON
curl -s -X POST \
  "https://api.nature.global/1/appliances/{APPLIANCE_ID}/light" \
  -H "Authorization: Bearer $TOKEN" \
  -d "button=on"

# ç…§æ˜ OFF
curl -s -X POST \
  "https://api.nature.global/1/appliances/{APPLIANCE_ID}/light" \
  -H "Authorization: Bearer $TOKEN" \
  -d "button=off"

# ã‚¨ã‚¢ã‚³ãƒ³è¨­å®š
curl -s -X POST \
  "https://api.nature.global/1/appliances/{APPLIANCE_ID}/aircon_settings" \
  -H "Authorization: Bearer $TOKEN" \
  -d "operation_mode=warm&temperature=26"
```

## ã¯ã¾ã‚Šã©ã“ã‚ ğŸª¤

æ˜¨æ—¥ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã§é­é‡ã—ãŸå•é¡Œã¨è§£æ±ºç­–ã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚

### 1. usbipd ã®ãƒ‘ã‚¹ãŒé€šã‚‰ãªã„

**ç—‡çŠ¶**: WSL ã‹ã‚‰ `usbipd` ã‚³ãƒãƒ³ãƒ‰ãŒè¦‹ã¤ã‹ã‚‰ãªã„

**åŸå› **: ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç›´å¾Œã¯ã‚·ã‚§ãƒ«ã®PATHã«åæ˜ ã•ã‚Œãªã„

**è§£æ±ºç­–**: ãƒ•ãƒ«ãƒ‘ã‚¹ã§å®Ÿè¡Œ
```powershell
& "C:\Program Files\usbipd-win\usbipd.exe" list
```

### 2. bind/attach ã«ç®¡ç†è€…æ¨©é™ãŒå¿…è¦

**ç—‡çŠ¶**: `usbipd bind` ã§ "Access denied" ã‚¨ãƒ©ãƒ¼

**åŸå› **: USB ãƒ‡ãƒã‚¤ã‚¹ã®ãƒã‚¤ãƒ³ãƒ‰ã«ã¯ç®¡ç†è€…æ¨©é™ãŒå¿…é ˆ

**è§£æ±ºç­–**: PowerShell ã¾ãŸã¯ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’**ã€Œç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œã€**ã§é–‹ã„ã¦ã‹ã‚‰å®Ÿè¡Œ
```powershell
# ç®¡ç†è€… PowerShell ã§å®Ÿè¡Œ
usbipd bind --busid 1-3
usbipd attach --wsl --busid 1-3
```

### 3. ã‚«ãƒ¡ãƒ©ã‚’ç‰©ç†çš„ã«å‹•ã‹ã™ã¨ USB ãŒåˆ‡ã‚Œã‚‹

**ç—‡çŠ¶**: ã‚«ãƒ¡ãƒ©ã®ä½ç½®ã‚’å¤‰ãˆãŸå¾Œã€`/dev/video0` ãŒæ¶ˆãˆã‚‹

**åŸå› **: USB ã®ç‰©ç†çš„ãªæŠœãå·®ã—ã§ usbipd ã®ã‚¢ã‚¿ãƒƒãƒãŒè§£é™¤ã•ã‚Œã‚‹

**è§£æ±ºç­–**: Windows å´ã§å†ã‚¢ã‚¿ãƒƒãƒ + WSL ã§æ¨©é™å†è¨­å®š
```powershell
# Windows (ç®¡ç†è€…)
usbipd attach --wsl --busid 1-3
```
```bash
# WSL
sudo chmod 666 /dev/video0 /dev/video1
```

### 4. WSL å†èµ·å‹•ã®ãŸã³ã«ã‚¢ã‚¿ãƒƒãƒãŒå¿…è¦

**ç—‡çŠ¶**: WSL ã‚’å†èµ·å‹•ã™ã‚‹ã¨ `/dev/video*` ãŒæ¶ˆãˆã‚‹

**åŸå› **: usbipd ã®ã‚¢ã‚¿ãƒƒãƒã¯ã‚»ãƒƒã‚·ãƒ§ãƒ³å˜ä½ã€‚WSL å†èµ·å‹•ã§è§£é™¤ã•ã‚Œã‚‹

**è§£æ±ºç­–**: æ¯å›æ‰‹å‹•ã§ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã‹ã€Windows ã®ã‚¿ã‚¹ã‚¯ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ã§è‡ªå‹•åŒ–
```powershell
# è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¾‹ (attach-camera.ps1)
usbipd attach --wsl --busid 1-3
```

### 5. /dev/video0 ã®æ¨©é™ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: `PermissionError: [Errno 13] Permission denied: '/dev/video0'`

**åŸå› **: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ `video` ã‚°ãƒ«ãƒ¼ãƒ—ã«æ‰€å±ã—ã¦ã„ãªã„

**è§£æ±ºç­–Aï¼ˆä¸€æ™‚çš„ï¼‰**:
```bash
sudo chmod 666 /dev/video0 /dev/video1
```

**è§£æ±ºç­–Bï¼ˆæ°¸ç¶šçš„ï¼‰**:
```bash
sudo usermod -aG video $USER
# ãƒ­ã‚°ã‚¢ã‚¦ãƒˆâ†’ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦
```

### 6. ç”»åƒã®è‰²ãŒãŠã‹ã—ã„ï¼ˆç´«/ãƒã‚¼ãƒ³ã‚¿ã®ãƒã‚¤ã‚ºï¼‰

**ç—‡çŠ¶**: æ’®å½±ã—ãŸç”»åƒã®ä¸€éƒ¨ãŒç´«è‰²ã«ãªã‚‹

**åŸå› **: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® YUYV ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã®è‰²å¤‰æ›ã®å•é¡Œ

**è§£æ±ºç­–**: MJPEG ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’æ˜ç¤ºçš„ã«æŒ‡å®š
```bash
# âŒ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆYUYVï¼‰ â€” è‰²ãŒãŠã‹ã—ããªã‚‹ã“ã¨ãŒã‚ã‚‹
ffmpeg -f v4l2 -i /dev/video0 -frames:v 1 /tmp/camera.jpg -y

# âœ… MJPEG æŒ‡å®š â€” è‰²ãŒæ­£ç¢º
ffmpeg -f v4l2 -input_format mjpeg -video_size 1920x1080 \
  -i /dev/video0 -frames:v 1 -update 1 /tmp/camera.jpg -y
```

### 7. ç”»åƒãŒä¸Šä¸‹é€†

**ç—‡çŠ¶**: ã‚«ãƒ¡ãƒ©ã®è¨­ç½®æ–¹å‘ã«ã‚ˆã£ã¦ç”»åƒãŒä¸Šä¸‹é€†ã«ãªã‚‹

**è§£æ±ºç­–**: `vflip` ãƒ•ã‚£ãƒ«ã‚¿ã§åè»¢ï¼ˆã‚«ãƒ¡ãƒ©ã®å‘ãã«åˆã‚ã›ã¦ä½¿ã†/ä½¿ã‚ãªã„ã‚’æ±ºã‚ã‚‹ï¼‰
```bash
# ä¸Šä¸‹åè»¢ãŒå¿…è¦ãªå ´åˆ
ffmpeg -f v4l2 -input_format mjpeg -video_size 1920x1080 \
  -i /dev/video0 -frames:v 1 -vf "vflip" -update 1 /tmp/camera.jpg -y
```

### 8. ã‚«ãƒ¡ãƒ©ã®å¯¾å¿œãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆç¢ºèª

```bash
# åˆ©ç”¨å¯èƒ½ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¨ã‚µã‚¤ã‚ºã®ä¸€è¦§
ffmpeg -f v4l2 -list_formats all -i /dev/video0
```

## æ“ä½œâ†’æ’®å½±â†’ç¢ºèªãƒ«ãƒ¼ãƒ—

AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ä¿¡é ¼æ€§ã‚’é«˜ã‚ã‚‹ãŸã‚ã«ã€æ“ä½œå¾Œã«ã‚«ãƒ¡ãƒ©ã§ç¢ºèªã™ã‚‹ãƒ«ãƒ¼ãƒ—ãŒé‡è¦ã§ã™ã€‚

```
1. ğŸ“· æ’®å½± â†’ éƒ¨å±‹ã®çŠ¶æ…‹ã‚’åˆ†æ
2. ğŸ¤” åˆ¤æ–­ â†’ ã€Œãƒ™ãƒƒãƒ‰å´ã®é›»æ°—ãŒã¤ã„ã¦ã‚‹ã€æ¶ˆã™ã¹ãã‹ï¼Ÿã€
3. ğŸ’¡ æ“ä½œ â†’ Nature Remo API ã§é›»æ°—ã‚’æ¶ˆã™
4. ğŸ“· å†æ’®å½± â†’ æœ¬å½“ã«æ¶ˆãˆãŸã‹ç¢ºèª
5. âœ… æ¤œè¨¼ â†’ å·¦å´ï¼ˆãƒ™ãƒƒãƒ‰å´ï¼‰ãŒæš—ããªã£ã¦ã„ã‚‹ â†’ æˆåŠŸ
```

Nature Remo ã®èµ¤å¤–ç·šä¿¡å·ã¯å±Šã‹ãªã„ã“ã¨ã‚‚ã‚ã‚‹ãŸã‚ã€ã“ã®ç¢ºèªã‚¹ãƒ†ãƒƒãƒ—ãŒé‡è¦ã§ã™ã€‚

## Nature Remo API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### å®¶é›»ä¸€è¦§å–å¾—
```bash
curl -s -H "Authorization: Bearer $TOKEN" \
  https://api.nature.global/1/appliances
```

### ç…§æ˜æ“ä½œ
| ãƒœã‚¿ãƒ³ | å‹•ä½œ |
|--------|------|
| `on` | ç‚¹ç¯ |
| `off` | æ¶ˆç¯ |
| `on-100` | å…¨ç¯ |
| `night` | å¸¸å¤œç¯ |
| `bright-up` | æ˜ã‚‹ã |
| `bright-down` | æš—ã |

### ã‚¨ã‚¢ã‚³ãƒ³æ“ä½œ
| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | å€¤ |
|-----------|-----|
| `operation_mode` | `cool`, `warm`, `dry`, `blow`, `auto` |
| `temperature` | æ¸©åº¦ (ä¾‹: `26`) |
| `air_volume` | `auto`, `1`-`10` |
| `air_direction` | `auto`, `swing`, `still` |
| `button` | ç©ºæ–‡å­—=å¤‰æ›´é©ç”¨, `power-off`=é›»æºOFF |

### ãƒ†ãƒ¬ãƒ“æ“ä½œ
```bash
curl -s -X POST \
  "https://api.nature.global/1/appliances/{ID}/tv" \
  -H "Authorization: Bearer $TOKEN" \
  -d "button=power"
```

## OpenClaw ã‚¹ã‚­ãƒ«

ã“ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’ OpenClaw ã‚¹ã‚­ãƒ«ã¨ã—ã¦ã‚‚å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚
è©³ã—ãã¯ [`skill/`](./skill/) ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ

- ğŸ‘» **ã‚†ã†ã‚Œã„ã¡ã‚ƒã‚“** (yuurei-chan) â€” ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆã€ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Ÿæ–½
- ğŸ§‘ **[furoku](https://github.com/furoku)** (ã²ã‚ã) â€” ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚ªãƒ¼ãƒŠãƒ¼ã€ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢æ‹…å½“

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT
